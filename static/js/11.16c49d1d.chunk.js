(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[11],{328:function(t,e,n){t.exports={main:"src-features-task_manage-push_article-PushArticle__main--2vKVi",top_main:"src-features-task_manage-push_article-PushArticle__top_main--1nJoW",input_title:"src-features-task_manage-push_article-PushArticle__input_title--3SJco",content:"src-features-task_manage-push_article-PushArticle__content--375SI",left_input:"src-features-task_manage-push_article-PushArticle__left_input--2fT4-",right_show:"src-features-task_manage-push_article-PushArticle__right_show--2HKGP"}},329:function(t,e,n){},634:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return F}));var a=n(327),i=n(10),s=n(11),l=n(31),r=n(16),o=n(15),c=n(0),u=n.n(c),h=n(328),p=n.n(h),g=(n(329),n(101)),d=n.n(g),f=n(330),v=n.n(f),b=(n(526),n(528)),m=n.n(b),_=n(616),j=n(126),x=(n(110),n(617)),I=n(19),O=n(632),C=n(137),S=n.n(C),k=n(618),y=n(629),V=n(637),T=n(638),w=n(639),A=n(2),D=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(){var t;Object(i.a)(this,n);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(t=e.call.apply(e,[this].concat(s))).state={tags:["React","\u524d\u7aef"],inputVisible:!1,inputValue:"",editInputIndex:-1,editInputValue:""},t.getResultTag=function(){return t.state.tags},t.handleClose=function(e){var n=t.state.tags.filter((function(t){return t!==e}));console.log(n),t.setState({tags:n})},t.showInput=function(){t.setState({inputVisible:!0},(function(){return t.input.focus()}))},t.handleInputChange=function(e){t.setState({inputValue:e.target.value})},t.handleInputConfirm=function(){var e=t.state.inputValue,n=t.state.tags;e&&-1===n.indexOf(e)&&(n=[].concat(Object(k.a)(n),[e])),console.log(n),t.setState({tags:n,inputVisible:!1,inputValue:""})},t.handleEditInputChange=function(e){t.setState({editInputValue:e.target.value})},t.handleEditInputConfirm=function(){t.setState((function(t){var e=t.tags,n=t.editInputIndex,a=t.editInputValue,i=Object(k.a)(e);return i[n]=a,{tags:i,editInputIndex:-1,editInputValue:""}}))},t.saveInputRef=function(e){t.input=e},t.saveEditInputRef=function(e){t.editInput=e},t}return Object(s.a)(n,[{key:"render",value:function(){var t=this,e=this.state,n=e.tags,a=e.inputVisible,i=e.inputValue,s=e.editInputIndex,l=e.editInputValue;return Object(A.jsxs)(A.Fragment,{children:[n.map((function(e,n){if(s===n)return Object(A.jsx)(y.a,{ref:t.saveEditInputRef,size:"small",className:"tag-input",value:l,onChange:t.handleEditInputChange,onBlur:t.handleEditInputConfirm,onPressEnter:t.handleEditInputConfirm},e);var a=e.length>20,i=Object(A.jsx)(V.a,{className:"edit-tag",closable:!0,onClose:function(){return t.handleClose(e)},children:Object(A.jsx)("span",{onDoubleClick:function(a){0!==n&&(t.setState({editInputIndex:n,editInputValue:e},(function(){t.editInput.focus()})),a.preventDefault())},children:a?"".concat(e.slice(0,20),"..."):e})},e);return a?Object(A.jsx)(T.a,{title:e,children:i},e):i})),a&&Object(A.jsx)(y.a,{ref:this.saveInputRef,type:"text",size:"small",className:"tag-input",value:i,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!a&&Object(A.jsxs)(V.a,{className:"site-tag-plus",onClick:this.showInput,children:[Object(A.jsx)(w.a,{})," New Tag"]})]})}}]),n}(u.a.Component),E=I.a.getState().login_reducer.dir_types;function N(t){var e,n=u.a.useState(E[0].objectId),a=Object(x.a)(n,2),i=a[0],s=a[1];return Object(A.jsxs)(S.a,{title:"\u8bf7\u786e\u8ba4\u76f8\u5173\u4fe1\u606f",visible:t.visible,onOk:function(){var n={type_id:i,tags:e.getResultTag()};t.onOk(n)},onCancel:t.onCancel,children:[Object(A.jsx)(O.a.Group,{onChange:function(t){console.log("radio checked",t.target.value),s(t.target.value)},value:i,children:E.map((function(t){return Object(A.jsx)(O.a,{value:t.objectId,children:t.name},t.objectId)}))}),Object(A.jsx)("br",{}),Object(A.jsx)("br",{}),Object(A.jsx)(D,{ref:function(t){e=t},callback_results:function(t){console.log(t)}})]})}var P=n(89),R={"Content-Type":"multipart/form-data;charset=UTF-8"},H=n(614);H.setOptions({renderer:new H.Renderer,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(t,e){if(e&&v.a.getLanguage(e))try{return v.a.highlight(e,t).value}catch(n){}try{return v.a.highlightAuto(t).value}catch(n){}return""}});var F=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(i.a)(this,n),console.log("ManageHome"),(s=e.call(this,t)).handleOk=function(t){console.log(t),s.setState({push_dialog_visible:!1}),console.log("\u771f\u6b63\u5f00\u59cb\u4e0a\u4f20\u6587\u7ae0");var e={title:s.state.title,tags:t.tags.join(","),type_id:t.type_id,content:s.state.textareaValue};console.log(e),P.a.pushArticle(e).then((function(t){console.log(t),t.objectId&&_.b.success("\u53d1\u5e03\u6210\u529f...",1).then((function(){console.log(Object(l.a)(s)),s.props.callback_tab_select(1)}))})).catch((function(t){_.b.error("\u4e0a\u4f20\u5931\u8d25 \u7a0d\u540e\u518d\u8bd5")}))},s.handleCancel=function(){s.setState({push_dialog_visible:!1})},s.pushArticle=function(){console.log("\u53d1\u5e03\u6587\u7ae0 \u5f39\u51fa\u786e\u8ba4\u4fe1\u606f"),s.setState({push_dialog_visible:!0})},s.onChangeTitle=function(t){s.setState({title:t.target.value})},s.drop=function(t){t.preventDefault();var e,n=Object(a.a)(t.dataTransfer.files);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i&&i.type.match("image.*")){s.postImage2Server(i);break}}}catch(l){n.e(l)}finally{n.f()}},s.pasteFileAction=function(t){var e=t.clipboardData,n=window.navigator.userAgent;if(t.clipboardData&&t.clipboardData.items){if(!(e.items&&2===e.items.length&&"string"===e.items[0].kind&&"file"===e.items[1].kind&&e.types&&2===e.types.length&&"text/plain"===e.types[0]&&"Files"===e.types[1]&&n.match(/Macintosh/i)&&Number(n.match(/Chrome\/(\d{2})/i)[1])<49))for(var a=0;a<e.items.length;a++){var i=e.items[a];if(console.log(i),"file"===i.kind){var l=i.getAsFile();if(0===l.size)return;-1!==l.name.indexOf("image")&&(console.log(l),s.postImage2Server(l));break}}}else console.log("\u65e0\u6cd5\u83b7\u53d6\u7c98\u8d34\u5185\u5bb9")},s.postImage2Server=function(t){console.log("postImage2Server");var e=Date.parse(new Date)/1e3,n="8192--"+e;n=d.a.MD5(n).toString();var a=new FormData;a.append("file",t),a.append("id",8192),a.append("ts",e),a.append("categories","jump-react"),a.append("sign",n),m()({method:"post",url:"https://api.superbed.cn/upload",headers:R,data:a}).then((function(t){var e=t.data.url;console.log("\u4e0a\u4f20\u6210\u529f url "+e);var n="![image]("+e+")\n";s.insert2TextEditer(s.left_input,n),s.setState({textareaValue:s.left_input.value})})).catch((function(t){console.log(t)}))},s.insert2TextEditer=function(t,e){if(console.log("insert2TextEditer "+e),document.selection)document.selection.createRange().text=e;else if("number"===typeof t.selectionStart&&"number"===typeof t.selectionEnd){var n=t.selectionStart,a=t.selectionEnd,i=n,s=t.value;t.value=s.substring(0,n)+e+s.substring(a,s.length),i+=e.length,t.selectionStart=t.selectionEnd=i}else t.value+=e},s.handleTextareaChange=function(t){s.setState({textareaValue:t.target.value})},s.leftTRScorll=function(t){if(t.target.scrollHeight-t.target.clientHeight===t.target.scrollTop)return console.log("\u5e95\u90e8"),void(s.right_show.scrollTop=s.right_show.scrollHeight-s.right_show.clientHeight);var e=s.right_show.scrollHeight/s.left_input.scrollHeight;e>1&&(e*=.9),s.right_show.scrollTop=t.target.scrollTop*e},s.state={textareaValue:"",push_dialog_visible:!1,title:""},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){console.log("PushArticle componentDidMount")}},{key:"render",value:function(){var t=this,e=H("# "+this.state.title),n=H(this.state.textareaValue);return Object(A.jsxs)("div",{className:p.a.main,children:[Object(A.jsxs)("div",{className:p.a.top_main,children:[Object(A.jsx)("input",{value:this.state.title,onChange:this.onChangeTitle,placeholder:"\u8bf7\u8f93\u5165\u6807\u9898",className:p.a.input_title}),Object(A.jsx)(j.a,{onClick:this.pushArticle,children:"\u53d1\u5e03"})]}),Object(A.jsxs)("div",{className:p.a.content,children:[Object(A.jsx)("textarea",{ref:function(e){t.left_input=e},onScroll:this.leftTRScorll,onDrop:this.drop,onDragOver:function(t){return t.preventDefault()},onPasteCapture:this.pasteFileAction,className:p.a.left_input,value:this.state.textareaValue,onChange:this.handleTextareaChange}),Object(A.jsx)("div",{ref:function(e){t.right_show=e},className:p.a.right_show,dangerouslySetInnerHTML:{__html:e+n}})]}),Object(A.jsx)(N,{visible:this.state.push_dialog_visible,onOk:this.handleOk,onCancel:this.handleCancel})]})}}]),n}(u.a.Component)}}]);
//# sourceMappingURL=11.16c49d1d.chunk.js.map