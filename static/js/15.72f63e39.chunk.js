(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[15],{539:function(t,e,a){t.exports={main:"src-features-task_manage-push_article-PushArticle__main--2vKVi",top_main:"src-features-task_manage-push_article-PushArticle__top_main--1nJoW",input_title:"src-features-task_manage-push_article-PushArticle__input_title--3SJco",content:"src-features-task_manage-push_article-PushArticle__content--375SI",left_input:"src-features-task_manage-push_article-PushArticle__left_input--2fT4-",right_show:"src-features-task_manage-push_article-PushArticle__right_show--2HKGP"}},540:function(t,e,a){},647:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return z}));var n=a(538),i=a(11),s=a(12),r=(a(64),a(22)),l=a(21),u=a(0),c=a.n(u),o=a(539),h=a.n(o),p=(a(540),a(51)),d=a.n(p),f=a(212),g=a.n(f),b=(a(214),a(541)),m=a.n(b),_=a(628),v=a(223),j=(a(82),a(38)),O=a(46),I=a(34),x=a(644),C=a(236),S=a.n(C),y=a(629),k=a(641),T=a(650),V=a(651),w=a(652),A=a(1),E=function(t){Object(r.a)(a,t);var e=Object(l.a)(a);function a(){var t;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).state={tags:["React","\u524d\u7aef"],inputVisible:!1,inputValue:"",editInputIndex:-1,editInputValue:""},t.getResultTag=function(){return t.state.tags},t.handleClose=function(e){var a=t.state.tags.filter((function(t){return t!==e}));t.setState({tags:a})},t.showInput=function(){t.setState({inputVisible:!0},(function(){return t.input.focus()}))},t.handleInputChange=function(e){t.setState({inputValue:e.target.value})},t.handleInputConfirm=function(){var e=t.state.inputValue,a=t.state.tags;e&&-1===a.indexOf(e)&&(a=[].concat(Object(y.a)(a),[e])),t.setState({tags:a,inputVisible:!1,inputValue:""})},t.handleEditInputChange=function(e){t.setState({editInputValue:e.target.value})},t.handleEditInputConfirm=function(){t.setState((function(t){var e=t.tags,a=t.editInputIndex,n=t.editInputValue,i=Object(y.a)(e);return i[a]=n,{tags:i,editInputIndex:-1,editInputValue:""}}))},t.saveInputRef=function(e){t.input=e},t.saveEditInputRef=function(e){t.editInput=e},t}return Object(s.a)(a,[{key:"render",value:function(){var t=this,e=this.state,a=e.tags,n=e.inputVisible,i=e.inputValue,s=e.editInputIndex,r=e.editInputValue;return Object(A.jsxs)(A.Fragment,{children:[a.map((function(e,a){if(s===a)return Object(A.jsx)(k.a,{ref:t.saveEditInputRef,size:"small",className:"tag-input",value:r,onChange:t.handleEditInputChange,onBlur:t.handleEditInputConfirm,onPressEnter:t.handleEditInputConfirm},e);var n=e.length>20,i=Object(A.jsx)(T.a,{className:"edit-tag",closable:!0,onClose:function(){return t.handleClose(e)},children:Object(A.jsx)("span",{onDoubleClick:function(n){0!==a&&(t.setState({editInputIndex:a,editInputValue:e},(function(){t.editInput.focus()})),n.preventDefault())},children:n?"".concat(e.slice(0,20),"..."):e})},e);return n?Object(A.jsx)(V.a,{title:e,children:i},e):i})),n&&Object(A.jsx)(k.a,{ref:this.saveInputRef,type:"text",size:"small",className:"tag-input",value:i,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!n&&Object(A.jsxs)(T.a,{className:"site-tag-plus",onClick:this.showInput,children:[Object(A.jsx)(w.a,{})," New Tag"]})]})}}]),a}(c.a.Component),D=I.a.getState().login_reducer.dir_types;function N(t){var e,a=c.a.useState(D[0].objectId),n=Object(j.a)(a,2),i=n[0],s=n[1],r=c.a.useState(""),l=Object(j.a)(r,2),o=l[0],h=l[1],p=c.a.useState(!1),d=Object(j.a)(p,2),f=d[0],g=d[1],b=c.a.useState([]),m=Object(j.a)(b,2),_=m[0],v=m[1];Object(u.useEffect)((function(){O.a.getAllTitlesTB_Type_Items("514b01f381").then((function(t){v(t)})).catch((function(t){}))}),[0]);return Object(A.jsxs)(S.a,{title:"\u8bf7\u786e\u8ba4\u76f8\u5173\u4fe1\u606f",visible:t.visible,onOk:function(){var a={type_id:i,type_item_id:o,tags:e.getResultTag()};t.onOk(a)},onCancel:t.onCancel,children:[Object(A.jsx)(x.a.Group,{onChange:function(t){"514b01f381"==t.target.value?g(!0):g(!1),s(t.target.value)},value:i,children:D.map((function(t){return Object(A.jsx)(x.a,{value:t.objectId,children:t.name},t.objectId)}))}),f?Object(A.jsxs)("div",{children:[Object(A.jsx)("br",{}),Object(A.jsx)("br",{}),Object(A.jsx)(x.a.Group,{onChange:function(t){h(t.target.value)},value:o,children:_.map((function(t){return Object(A.jsx)(x.a,{value:t.objectId,children:t.name},t.objectId)}))})]}):null,Object(A.jsx)("br",{}),Object(A.jsx)("br",{}),Object(A.jsx)(E,{ref:function(t){e=t},callback_results:function(t){}})]})}var R,P={"Content-Type":"multipart/form-data;charset=UTF-8"},H=I.a.getState().login_reducer.login_user.ttt,F=a(215);F.setOptions({renderer:new F.Renderer,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(t,e){if(e&&g.a.getLanguage(e))try{return g.a.highlight(e,t).value}catch(a){}try{return g.a.highlightAuto(t).value}catch(a){}return""}});var z=function(t){Object(r.a)(a,t);var e=Object(l.a)(a);function a(t){var s;return Object(i.a)(this,a),(s=e.call(this,t)).updateInputValue=function(t){s.setState({textareaValue:t}),R&&clearTimeout(R),R=setTimeout((function(){s.setState({_html_str:F(s.state.textareaValue)}),clearTimeout(R)}),500)},s.handleTextareaChange=function(t){s.updateInputValue(t.target.value)},s.handleOk=function(t){s.setState({push_dialog_visible:!1});var e={title:s.state.title,tags:t.tags.join(","),type_id:t.type_id,type_item_id:t.type_item_id,content:s.state.textareaValue};O.a.pushArticle(e).then((function(t){t.objectId&&_.b.success("\u53d1\u5e03\u6210\u529f...",1).then((function(){s.props.callback_tab_select(1)}))})).catch((function(t){_.b.error("\u4e0a\u4f20\u5931\u8d25 \u7a0d\u540e\u518d\u8bd5")}))},s.handleCancel=function(){s.setState({push_dialog_visible:!1})},s.pushArticle=function(){s.setState({push_dialog_visible:!0})},s.onChangeTitle=function(t){s.setState({title:t.target.value})},s.drop=function(t){t.preventDefault();var e,a=Object(n.a)(t.dataTransfer.files);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(i&&i.type.match("image.*")){s.postImage2Server(i);break}}}catch(r){a.e(r)}finally{a.f()}},s.pasteFileAction=function(t){var e=t.clipboardData,a=window.navigator.userAgent;if(t.clipboardData&&t.clipboardData.items&&!(e.items&&2===e.items.length&&"string"===e.items[0].kind&&"file"===e.items[1].kind&&e.types&&2===e.types.length&&"text/plain"===e.types[0]&&"Files"===e.types[1]&&a.match(/Macintosh/i)&&Number(a.match(/Chrome\/(\d{2})/i)[1])<49))for(var n=0;n<e.items.length;n++){var i=e.items[n];if("file"===i.kind){var r=i.getAsFile();if(0===r.size)return;-1!==r.name.indexOf("image")&&s.postImage2Server(r);break}}},s.postImage2Server=function(t){var e=Date.parse(new Date)/1e3,a="8192-"+H+"-"+e;a=d.a.MD5(a).toString();var n=new FormData;n.append("file",t),n.append("id",8192),n.append("ts",e),n.append("categories","jump-react"),n.append("sign",a),m()({method:"post",url:"https://api.superbed.cn/upload",headers:P,data:n}).then((function(t){var e="![image]("+t.data.url+")\n";s.insert2TextEditer(s.left_input,e),s.updateInputValue(s.left_input.value)})).catch((function(t){}))},s.insert2TextEditer=function(t,e){if(document.selection)document.selection.createRange().text=e;else if("number"===typeof t.selectionStart&&"number"===typeof t.selectionEnd){var a=t.selectionStart,n=t.selectionEnd,i=a,s=t.value;t.value=s.substring(0,a)+e+s.substring(n,s.length),i+=e.length,t.selectionStart=t.selectionEnd=i}else t.value+=e},s.leftTRScorll=function(t){if(t.target.scrollHeight-t.target.clientHeight!==t.target.scrollTop){var e=s.right_show.scrollHeight/s.left_input.scrollHeight;e>1&&(e*=.9),s.right_show.scrollTop=t.target.scrollTop*e}else s.right_show.scrollTop=s.right_show.scrollHeight-s.right_show.clientHeight},s.state={textareaValue:"",push_dialog_visible:!1,title:"",_html_str:""},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=this,e=F("# "+this.state.title);return Object(A.jsxs)("div",{className:h.a.main,children:[Object(A.jsxs)("div",{className:h.a.top_main,children:[Object(A.jsx)("input",{value:this.state.title,onChange:this.onChangeTitle,placeholder:"\u8bf7\u8f93\u5165\u6807\u9898",className:h.a.input_title}),Object(A.jsx)(v.a,{onClick:this.pushArticle,children:"\u53d1\u5e03"})]}),Object(A.jsxs)("div",{className:h.a.content,children:[Object(A.jsx)("textarea",{ref:function(e){t.left_input=e},onScroll:this.leftTRScorll,onDrop:this.drop,onDragOver:function(t){return t.preventDefault()},onPasteCapture:this.pasteFileAction,className:h.a.left_input,value:this.state.textareaValue,onChange:this.handleTextareaChange}),Object(A.jsx)("div",{ref:function(e){t.right_show=e},className:h.a.right_show,dangerouslySetInnerHTML:{__html:e+this.state._html_str}})]}),Object(A.jsx)(N,{visible:this.state.push_dialog_visible,onOk:this.handleOk,onCancel:this.handleCancel})]})}}]),a}(c.a.Component)}}]);
//# sourceMappingURL=15.72f63e39.chunk.js.map